{"version":3,"file":"bundles/pages/index.js","sources":["webpack:///webpack/bootstrap 8b005d68b2aff4880ad6","webpack:///components/Chat.js","webpack:///components/ChatMessage.js","webpack:///components/Layout.js","webpack:///pages/index.js","webpack:///external \"axios\"","webpack:///external \"next/head\"","webpack:///external \"pusher-js\"","webpack:///external \"react\""],"sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tvar threw = true;\n \t\ttry {\n \t\t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n \t\t\tthrew = false;\n \t\t} finally {\n \t\t\tif(threw) delete installedModules[moduleId];\n \t\t}\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 8b005d68b2aff4880ad6","import React, { Component, Fragment } from \"react\";\nimport axios from \"axios\";\nimport Pusher from \"pusher-js\";\nimport ChatMessage from \"./ChatMessage\";\n\nconst SAD_EMOJI = [55357, 56864];\nconst HAPPY_EMOJI = [55357, 56832];\nconst NEUTRAL_EMOJI = [55357, 56848];\n\nclass Chat extends Component {\n  state = { chats: [] };\n\n  componentDidMount() {\n    this.pusher = new Pusher(process.env.PUSHER_APP_KEY, {\n      cluster: process.env.PUSHER_APP_CLUSTER,\n      encrypted: true\n    });\n\n    this.channel = this.pusher.subscribe(\"chat-room\");\n\n    this.channel.bind(\"new-message\", ({ chat = null }) => {\n      const { chats } = this.state;\n      chat && chats.push(chat);\n      this.setState({ chats });\n    });\n\n    this.pusher.connection.bind(\"connected\", () => {\n      axios.post(\"/messages\").then(response => {\n        const chats = response.data.messages;\n        this.setState({ chats });\n      });\n    });\n  }\n\n  componentWillUnmount() {\n    this.pusher.disconnect();\n  }\n\n  handleKeyUp = evt => {\n    const value = evt.target.value;\n\n    if (evt.keyCode === 13 && !evt.shiftKey) {\n      const { activeUser: user } = this.props;\n      const chat = { user, message: value, timestamp: +new Date() };\n\n      evt.target.value = \"\";\n      axios.post(\"/message\", chat);\n    }\n  };\n\n  render() {\n    return (\n      this.props.activeUser && (\n        <Fragment>\n          <div\n            className=\"border-bottom border-gray w-100 d-flex align-items-center bg-white\"\n            style={{ height: 90 }}\n          >\n            <h2 className=\"text-dark mb-0 mx-4 px-2\">\n              {this.props.activeUser}\n            </h2>\n          </div>\n\n          <div\n            className=\"px-4 pb-4 w-100 d-flex flex-row flex-wrap align-items-start align-content-start position-relative\"\n            style={{ height: \"calc(100% - 180px)\", overflowY: \"scroll\" }}\n          >\n            {this.state.chats.map((chat, index) => {\n              const previous = Math.max(0, index - 1);\n              const previousChat = this.state.chats[previous];\n              const position =\n                chat.user === this.props.activeUser ? \"right\" : \"left\";\n\n              const isFirst = previous === index;\n              const inSequence = chat.user === previousChat.user;\n              const hasDelay =\n                Math.ceil(\n                  (chat.timestamp - previousChat.timestamp) / (1000 * 60)\n                ) > 1;\n\n              const mood =\n                chat.sentiment > 0\n                  ? HAPPY_EMOJI\n                  : chat.sentiment === 0\n                    ? NEUTRAL_EMOJI\n                    : SAD_EMOJI;\n\n              return (\n                <Fragment key={index}>\n                  {(isFirst || !inSequence || hasDelay) && (\n                    <div\n                      className={`d-block w-100 font-weight-bold text-dark mt-4 pb-1 px-1 text-${position}`}\n                      style={{ fontSize: \"0.9rem\" }}\n                    >\n                      <span className=\"d-block\" style={{ fontSize: \"1.6rem\" }}>\n                        {String.fromCodePoint(...mood)}\n                      </span>\n                      <span>{chat.user || \"Anonymous\"}</span>\n                    </div>\n                  )}\n\n                  <ChatMessage message={chat.message} position={position} />\n                </Fragment>\n              );\n            })}\n          </div>\n\n          <div\n            className=\"border-top border-gray w-100 px-4 d-flex align-items-center bg-light\"\n            style={{ minHeight: 90 }}\n          >\n            <textarea\n              className=\"form-control px-3 py-2\"\n              onKeyUp={this.handleKeyUp}\n              placeholder=\"Enter a chat message\"\n              style={{ resize: \"none\" }}\n            />\n          </div>\n        </Fragment>\n      )\n    );\n  }\n}\n\nexport default Chat;\n\n\n\n// WEBPACK FOOTER //\n// components/Chat.js","import React, { Component } from \"react\";\n\nclass ChatMessage extends Component {\n  render() {\n    const { position = \"left\", message } = this.props;\n    const isRight = position.toLowerCase() === \"right\";\n\n    const align = isRight ? \"text-right\" : \"text-left\";\n    const justify = isRight ? \"justify-content-end\" : \"justify-content-start\";\n\n    const messageBoxStyles = {\n      maxWidth: \"70%\",\n      flexGrow: 0\n    };\n\n    const messageStyles = {\n      fontWeight: 500,\n      lineHeight: 1.4,\n      whiteSpace: \"pre-wrap\"\n    };\n\n    return (\n      <div className={`w-100 my-1 d-flex ${justify}`}>\n        <div\n          className=\"bg-light rounded border border-gray p-2\"\n          style={messageBoxStyles}\n        >\n          <span\n            className={`d-block text-secondary ${align}`}\n            style={messageStyles}\n          >\n            {message}\n          </span>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ChatMessage;\n\n\n\n// WEBPACK FOOTER //\n// components/ChatMessage.js","import React, { Fragment } from \"react\";\nimport Head from \"next/head\";\n\nconst Layout = props => (\n  <Fragment>\n    <Head>\n      <meta charSet=\"utf-8\" />\n      <meta\n        name=\"viewport\"\n        content=\"width=device-width, initial-scale=1, shrink-to-fit=no\"\n      />\n      <link\n        rel=\"stylesheet\"\n        href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css\"\n        integrity=\"sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm\"\n        crossOrigin=\"anonymous\"\n      />\n      <title>{props.pageTitle || \"Realtime Chat\"}</title>\n    </Head>\n    {props.children}\n  </Fragment>\n);\n\nexport default Layout;\n\n\n\n// WEBPACK FOOTER //\n// components/Layout.js","import React, { Component } from \"react\";\nimport Layout from \"../components/Layout\";\nimport Chat from \"../components/Chat\";\n\nclass IndexPage extends Component {\n  state = { user: null };\n\n  handleKeyUp = evt => {\n    if (evt.keyCode === 13) {\n      const user = evt.target.value;\n      this.setState({ user });\n    }\n  };\n\n  render() {\n    const { user } = this.state;\n\n    const nameInputStyles = {\n      background: \"transparent\",\n      color: \"#999\",\n      border: 0,\n      borderBottom: \"1px solid #666\",\n      borderRadius: 0,\n      fontSize: \"3rem\",\n      fontWeight: 500,\n      boxShadow: \"none !important\"\n    };\n\n    return (\n      <Layout pageTitle=\"Realtime chat\">\n        <main className=\"container-fluid position-absolute h-100 bg-dark\">\n          <div className=\"row position-absolute w-100 h-100\">\n            <section className=\"col-md-8 d-flex flex-row flex-wrap align-items-center align-content-center px-5\">\n              <div className=\"px-5 mx-5\">\n                <span\n                  className=\"d-block w-100 h1 text-light\"\n                  style={{ marginTop: -50 }}\n                >\n                  {user ? (\n                    <span>\n                      <span style={{ color: \"#999\" }}>Hello! </span> {user}\n                    </span>\n                  ) : (\n                    `What is your name?`\n                  )}\n                </span>\n\n                {!user && (\n                  <input\n                    type=\"text\"\n                    className=\"form-control mt-3 px-3 py-2\"\n                    onKeyUp={this.handleKeyUp}\n                    autoComplete=\"off\"\n                    style={nameInputStyles}\n                  />\n                )}\n              </div>\n            </section>\n\n            <section className=\"col-md-4 position-relative d-flex flex-wrap h-100 align-items-start align-content-between bg-white px-0\">\n              {user && <Chat activeUser={user} />}\n            </section>\n          </div>\n        </main>\n      </Layout>\n    );\n  }\n}\n\nexport default () => <IndexPage />;\n\n\n\n// WEBPACK FOOTER //\n// pages/index.js","module.exports = require(\"axios\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"axios\"\n// module id = axios\n// module chunks = 3","module.exports = require(\"next/head\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"next/head\"\n// module id = next/head\n// module chunks = 3","module.exports = require(\"pusher-js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"pusher-js\"\n// module id = pusher-js\n// module chunks = 3","module.exports = require(\"react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = react\n// module chunks = 3"],"mappings":"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","sourceRoot":""}